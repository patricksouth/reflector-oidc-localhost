# A really down spec httpd conf file, suitable for running on localhost only - don't use on a public httpd server.

<VirtualHost *:80>
  ServerName http://localhost:80

  <Directory /var/www/html>
  </Directory>


  RewriteEngine On
  RewriteCond %{HTTPS} off
  RewriteRule ^ https://localhost%{REQUEST_URI} [R=302,L,QSA]
</VirtualHost>

<IfModule mod_ssl.c>
  <VirtualHost _default_:443>

  ServerName localhost

  DocumentRoot /var/www/html

  SSLEngine on
  SSLCertificateFile /etc/ssl/certs/server.crt
  SSLCertificateKeyFile /etc/ssl/private/server.key
  SSLProtocol all -SSLv2 -SSLv3
  SSLCipherSuite EECDH+AESGCM:EDH+AESGCM:AES256+EECDH:AES256+EDH
  SSLHonorCipherOrder on

#  Header always set Strict-Transport-Security "max-age=63072000; includeSubDomains"

  ErrorLog ${APACHE_LOG_DIR}/error.log
  CustomLog ${APACHE_LOG_DIR}/access.log combined


  <FilesMatch "\.(cgi|shtml|phtml|php)$">
    SSLOptions +StdEnvVars
  </FilesMatch>

  LogLevel warn

#  ErrorDocument 404 /error.html
#  ErrorDocument 403 /error.html 
#  ErrorDocument 401 /error.html
  ErrorDocument 400 /error.php
  
# "Sorry, can't allow you access today"
  <Directory /var/www/html>
  </Directory>

    <Directory /var/www/html/secure/>
      AuthType openid-connect
      Require valid-user
      OIDCUnAuthAction auth
      LogLevel debug
      LogLevel auth_openidc:debug
    </Directory>

  </VirtualHost>
</IfModule>

